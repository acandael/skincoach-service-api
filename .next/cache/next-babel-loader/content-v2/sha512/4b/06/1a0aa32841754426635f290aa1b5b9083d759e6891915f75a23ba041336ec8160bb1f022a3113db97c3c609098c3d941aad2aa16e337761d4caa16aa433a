{"ast":null,"code":"const {\n  formatCurrency\n} = require(\"../../lib/currency\");\n\nconst {\n  orders\n} = require(\"../crystallize\");\n\nconst {\n  sendEmail,\n  mjml2html\n} = require(\"./utils\");\n\nmodule.exports = async function sendOrderConfirmation(orderId) {\n  try {\n    const order = await orders.getOrder(orderId);\n    const {\n      email\n    } = order.customer.addresses[0];\n    console.log(order);\n\n    if (!email) {\n      return {\n        success: false,\n        error: \"No email is conntected with the customer object\"\n      };\n    }\n\n    const {\n      html\n    } = mjml2html(`\n      <mjml>\n        <mj-body>\n        <mj-section>\n          <mj-column>\n            <mj-text>\n              <h1>Order Summary</h1>\n              \n            </mj-text>\n            \n          </mj-column>\n        </mj-section>\n        </mj-body>\n      </mjml>\n    `);\n    await sendEmail({\n      to: email,\n      subject: \"Order summary\",\n      html\n    });\n    return {\n      success: true\n    };\n  } catch (error) {\n    console.log(error);\n    return {\n      success: false,\n      error\n    };\n  }\n};","map":{"version":3,"sources":["/Users/acandael/Sites/crystallize-app/src/services/email-service/order-confirmation.js"],"names":["formatCurrency","require","orders","sendEmail","mjml2html","module","exports","sendOrderConfirmation","orderId","order","getOrder","email","customer","addresses","console","log","success","error","html","to","subject"],"mappings":"AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAqBC,OAAO,CAAC,oBAAD,CAAlC;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAaD,OAAO,CAAC,gBAAD,CAA1B;;AACA,MAAM;AAAEE,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA2BH,OAAO,CAAC,SAAD,CAAxC;;AAEAI,MAAM,CAACC,OAAP,GAAiB,eAAeC,qBAAf,CAAqCC,OAArC,EAA8C;AAC7D,MAAI;AACF,UAAMC,KAAK,GAAG,MAAMP,MAAM,CAACQ,QAAP,CAAgBF,OAAhB,CAApB;AAEA,UAAM;AAAEG,MAAAA;AAAF,QAAYF,KAAK,CAACG,QAAN,CAAeC,SAAf,CAAyB,CAAzB,CAAlB;AAEAC,IAAAA,OAAO,CAACC,GAAR,CAAYN,KAAZ;;AAEA,QAAI,CAACE,KAAL,EAAY;AACV,aAAO;AACLK,QAAAA,OAAO,EAAE,KADJ;AAELC,QAAAA,KAAK,EAAE;AAFF,OAAP;AAID;;AAED,UAAM;AAAEC,MAAAA;AAAF,QAAWd,SAAS,CAAE;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAd8B,CAA1B;AAgBA,UAAMD,SAAS,CAAC;AACdgB,MAAAA,EAAE,EAAER,KADU;AAEdS,MAAAA,OAAO,EAAE,eAFK;AAGdF,MAAAA;AAHc,KAAD,CAAf;AAMA,WAAO;AACLF,MAAAA,OAAO,EAAE;AADJ,KAAP;AAGD,GAvCD,CAuCE,OAAOC,KAAP,EAAc;AACdH,IAAAA,OAAO,CAACC,GAAR,CAAYE,KAAZ;AACA,WAAO;AACLD,MAAAA,OAAO,EAAE,KADJ;AAELC,MAAAA;AAFK,KAAP;AAID;AACF,CA/CD","sourcesContent":["const { formatCurrency } = require(\"../../lib/currency\");\nconst { orders } = require(\"../crystallize\");\nconst { sendEmail, mjml2html } = require(\"./utils\");\n\nmodule.exports = async function sendOrderConfirmation(orderId) {\n  try {\n    const order = await orders.getOrder(orderId);\n\n    const { email } = order.customer.addresses[0];\n\n    console.log(order)\n\n    if (!email) {\n      return {\n        success: false,\n        error: \"No email is conntected with the customer object\",\n      };\n    }\n\n    const { html } = mjml2html(`\n      <mjml>\n        <mj-body>\n        <mj-section>\n          <mj-column>\n            <mj-text>\n              <h1>Order Summary</h1>\n              \n            </mj-text>\n            \n          </mj-column>\n        </mj-section>\n        </mj-body>\n      </mjml>\n    `);\n\n    await sendEmail({\n      to: email,\n      subject: \"Order summary\",\n      html,\n    });\n\n    return {\n      success: true,\n    };\n  } catch (error) {\n    console.log(error);\n    return {\n      success: false,\n      error,\n    };\n  }\n};\n"]},"metadata":{},"sourceType":"script"}