"use strict";(()=>{var e={};e.id=268,e.ids=[268],e.modules={4400:e=>{e.exports=require("@mollie/api-client")},7644:e=>{e.exports=require("invariant")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},4809:e=>{e.exports=require("node-fetch")},9066:(e,r,o)=>{o.r(r),o.d(r,{config:()=>p,default:()=>n,routeModule:()=>u});var t={};o.r(t),o.d(t,{default:()=>webhookMollieOrderUpdate});var a=o(1802),d=o(7153),i=o(6249),s=o(3025),l=o.n(s);async function webhookMollieOrderUpdate(e,r){try{console.log("webhookMollieOrderUpdate",e.body.id),await l()({mollieOrderId:e.body.id}),r.status(200).send("ok")}catch(e){console.log("Error at mollieOrderUpdate webhook"),console.log(e),r.status(500).send("error")}}let n=(0,i.l)(t,"default"),p=(0,i.l)(t,"config"),u=new a.PagesAPIRouteModule({definition:{kind:d.x.PAGES_API,page:"/api/webhooks/payment-providers/mollie/order-update",pathname:"/api/webhooks/payment-providers/mollie/order-update",bundlePath:"",filename:""},userland:t})},3025:(e,r,o)=>{let t=o(6784),{getClient:a}=o(6954),d=o(9514);e.exports=async function({mollieOrderId:e}){let r=await a(),o=await r.payments.get(e),i=await r.customers.get(o.customerId),s=d({mollieOrder:o,mollieCustomer:i}),{crystallizeOrderId:l}=o.metadata;await t.orders.waitForOrderToBePersistated({id:l}),await t.orders.updateOrder(l,s)}}};var r=require("../../../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),o=r.X(0,[222,784,911],()=>__webpack_exec__(9066));module.exports=o})();