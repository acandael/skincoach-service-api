"use strict";(()=>{var e={};e.id=677,e.ids=[677],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7317:(e,o,r)=>{r.r(o),r.d(o,{config:()=>p,default:()=>d,routeModule:()=>c});var n={};r.r(n),r.d(n,{default:()=>webhookOrderPipelineStageChanged});var a=r(1802),i=r(7153),l=r(6249),s=r(1404),t=r.n(s);async function webhookOrderPipelineStageChanged(e,o){try{await t()(e.body),o.status(200).send("ok")}catch(e){console.log("Error at orderPipelineStageChanged webhook"),console.log(e),o.status(500).send("error")}}let d=(0,l.l)(n,"default"),p=(0,l.l)(n,"config"),c=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/webhooks/order/pipeline-stage-changed",pathname:"/api/webhooks/order/pipeline-stage-changed",bundlePath:"",filename:""},userland:n})},1404:e=>{e.exports=function(e){console.log("Webhook payload: orderPipelineStageChanged"),console.log(JSON.stringify(e,null,2));let{order:{get:o}}=e;console.log("Order pipeline update for",o.id),console.log("The order is in",o.pipelines.length,"pipeline(s)");let r=o.pipelines.map(({pipeline:e,stageId:o})=>{let{name:r}=e,n=e.stages?.find(e=>e.id===o)?.name;return console.log(`Pipeline "${r}" is in stage "${n}"`),{name:r,stageName:n}}),n=r.find(e=>"In store pickup"===e.name);if(n)switch(n.stageName){case"New":console.log("Notify staff of new order");break;case"Packing":console.log("Inform the user: packing begun");break;case"Ready":console.log("Inform the user: ready for pickup");break;case"Delivered":console.log("Capture order amount from payment provider");break;case"Cancelled":console.log("Refund order amount from payment provider")}}}};var o=require("../../../../webpack-api-runtime.js");o.C(e);var __webpack_exec__=e=>o(o.s=e),r=o.X(0,[222],()=>__webpack_exec__(7317));module.exports=r})();