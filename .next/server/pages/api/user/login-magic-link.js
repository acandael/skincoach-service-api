"use strict";(()=>{var e={};e.id=198,e.ids=[198],e.modules={2139:e=>{e.exports=require("@sendgrid/mail")},7644:e=>{e.exports=require("invariant")},9344:e=>{e.exports=require("jsonwebtoken")},2009:e=>{e.exports=require("mjml")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},4809:e=>{e.exports=require("node-fetch")},2704:(e,t,i)=>{i.r(t),i.d(t,{config:()=>l,default:()=>d,routeModule:()=>c});var r={};i.r(r),i.d(r,{default:()=>loginMagicLink});var n=i(1802),a=i(7153),o=i(6249),s=i(8020),u=i.n(s);async function loginMagicLink(e,t){try{let{success:i,signedLoginToken:r,redirectURLAfterLogin:n}=await u().validateMagicLinkToken(e.query.token);if(i)return t.setHeader("Set-Cookie",`${u().USER_TOKEN_NAME}=${r}; HttpOnly; Max-Age=3600; Path=/`),t.setHeader("Location",n),t.status(302).send("User is authenticated");return t.status(400).send("User could not be authenticated")}catch(e){console.log(e),t.status(500).send("Something went wrong when trying to authenticated the user")}}let d=(0,o.l)(r,"default"),l=(0,o.l)(r,"config"),c=new n.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/user/login-magic-link",pathname:"/api/user/login-magic-link",bundlePath:"",filename:""},userland:r})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),i=t.X(0,[222,784,958,46],()=>__webpack_exec__(2704));module.exports=i})();