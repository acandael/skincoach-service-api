"use strict";exports.id=46,exports.ids=[46],exports.modules={8020:(e,n,s)=>{let t=s(9344),i=s(7644),r=s(8958),a=process.env.JWT_SECRET;e.exports={USER_TOKEN_NAME:"user-token",getLogoutLink({context:e}){let{publicHost:n}=e;return`${n}/api/user/logout`},authenticate(e){if(i(a,"process.env.JWT_SECRET is not defined"),!e)return null;let n=t.verify(e,a);return n?{email:n.email}:null},async sendMagicLink({email:e,redirectURLAfterLogin:n,context:s}){i(a,"process.env.JWT_SECRET is not defined");let{publicHost:o}=s,l=new URL(`${o}/api/user/login-magic-link`);l.searchParams.append("token",t.sign({email:e,redirectURLAfterLogin:n},a,{expiresIn:"36000s"}));let{success:c}=await r.sendUserMagicLink({loginLink:l.toString(),email:e});return{success:c}},async sendGiftCard({email:e,aanbieder:n,message:s,amount:t}){let{success:i}=await r.sendGiftCard({email:e,aanbieder:n,message:s,amount:t});return{success:i}},validateMagicLinkToken(e){i(a,"process.env.JWT_SECRET is not defined");try{let n=t.verify(e,a),{email:s,redirectURLAfterLogin:i}=n,r=t.sign({email:s},a,{expiresIn:"24h"});return{success:!0,signedLoginToken:r,redirectURLAfterLogin:i}}catch(e){return console.log(e),{success:!1,error:e}}}}}};